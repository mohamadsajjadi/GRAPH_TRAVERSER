<div dir="rtl">

به نام خدا

# توسعه آزمون‌رانه و پوشش آزمون (Test-driven Development and Test Coverage)

## اهداف 
- آشنایی با روش ایجاد آزمون‌رانه (Test-driven Development) نرم‌افزار
- آشنایی دانشجویان با مفهوم پوشش آزمون با کمک یک برنامه ساده


## نیازمندی‌ها
- آشنایی اولیه با زبان جاوا و نحوه نوشتن تست برای آن
- انجام آزمایش [git](https://github.com/ssc-public/Software-Engineering-Lab/blob/main/instructions/git.md)

## ابزارهای مورد استفاده
- یک محیط برنامه‌نویسی برای زبان جاوا ترجیحا IntelliJ سال ۲۰۱۸ به بعد به شما کمک خواهد.
- کتابخانه Junit

## منابع آموزشی
- [ویدئو آشنایی با TDD](https://piped.video/watch?v=3m1Xtj8rKDg&list=PLnEg28Nx10WERRUmbl_hf7Y7rqacWWeNq&index=2)
- [اسلاید آشنایی با TDD](https://github.com/ssc-public/Software-Engineering-Lab/blob/main/educational-resources/TDD/An-Introduction-To-TDD.pptx)
- [راه‌اندازی JUnit در پروژه](https://www.jetbrains.com/help/idea/junit.html)
- [الگوی Arrange-Act-Assert برای سامان‌دهی ساختار یک Unit Test](https://java-design-patterns.com/patterns/arrange-act-assert/)
- [مدل شایستگی مهندسی نرم‌افزار در حوزه‌ی آزمون](https://docs.google.com/spreadsheets/d/1MeBzWbmPpv4FWnpn1GmzHOLP8Sl4F2d11Zb_rYz9HVo/edit?usp=sharing)

## مفاهیم

### آزمون واحد (Unit Test)
آزمون واحد یک روش آزمودن نرم‌افزار است که در آن بخش‌های کوچک و مستقل نرم‌افزار (معمولاً توابع یا متدها) به صورت جداگانه و در محیط کنترل شده بررسی می‌شوند. هدف از این test ها اطمینان از صحت عملکرد هر بخش به‌تنهایی است.

## پوشش آزمون
منظور ما از پوشش آزمون آن است که مشخص کنیم موارد آزمون (Test Cases) تا چه اندازه کد اصلی برنامه را مورد آزمون قرار می‌دهند و در واقع چند درصد از کد برنامه توسط این موارد، اجرا و تست می‌شوند. پوشش آزمون می‌تواند توسط معیارهایی نظیر تعداد کلاس‌ها، متدها و خطوط بررسی شود و به‌صورت خودکار از طریق ابزارهایی قابل محاسبه است.


## آزمایش ابتدایی برای گرفتن پوشش آزمون

1. [پروژه json-simle](https://github.com/ssc-public/Software-Engineering-Lab/tree/main/base-projects/json-simple) را در محیط IntelliJ باز (import) کنید. در صورتی که فایل‌های برنامه با خطا مواجه شدند و کتابخانه Test را شناسایی نکرده‌اند باید JUnit4 را اضافه کرد. SDK هم از قبل باید نصب شده باشد. ساختار پروژه شامل دو پکیج اصلی main و test است که حاوی کدهای برنامه و کد کلاس تست می‌باشد.
2. کلاس تست TestJson شامل متدهایی جهت تست کلاس‌های اصلی است ولی این متدها همه کلاس‌ها را تست نمی‌کنند. برای یافتن اینکه چند درصد از کلاس‌ها، متدها و خطوط برنامه اصلی توسط TestJson مورد تست قرار می ‌گیرند بر روی کلاس تست، کلیک راست کرده و گزینه Run TestJson with Coverage را انتخاب می‌کنیم. (اگر درصدهای Coverage نشان داده نشده است باید قسمت Edit Configuration را از پنل Coverage کلیک کرد و سپس در قسمت مربوط به Coverage گزینه مربوط به ذخیره خروجی Coverage را انتخاب کرد.)

![image](https://user-images.githubusercontent.com/45389673/230716764-52e1021f-4687-43cd-8139-3e65b152b2f0.png)

![image](https://user-images.githubusercontent.com/45389673/230716778-47ed926e-ab65-4d48-ae1f-47f24715eefd.png)

![image](https://user-images.githubusercontent.com/45389673/230716779-c0bfbc6a-47b8-48e8-bc1e-8a226a8cb2b3.png)

![image](https://user-images.githubusercontent.com/45389673/230716782-1d781c37-3dbb-4f67-be02-410e7d72dd69.png)

برای اینکه با روال کار بهتر آشنا شوید، می‌توانید با گذاشتن breakpoint بر روی یکی از متدهای تست، روند debug آن و پیمایش خطوط برنامه را مشاهده کنید. با استفاده از گزینه Generate Coverage Report (فلش زردرنگ در تصویر فوق) می‌توان گزارشی به فرمت html حاوی خلاصه درصدهای پوشش، خطوط پوشش داده شده (با رنگ سبز) و خطوطی که پوشش داده نشده (خطوط قرمز) را مشاهده کرد.

![image](https://user-images.githubusercontent.com/45389673/230716790-d0f4edae-8e0a-4da8-96ee-ca593754ee61.png)

![image](https://user-images.githubusercontent.com/45389673/230716794-ff87d104-ceb0-4913-af56-91ed069c9455.png)

با کلیک بر روی لینک هر یک از فایل‌های گزارش، خطوط پوشش داده شده (به رنگ سبز) و نشده (به رنگ قرمز) نمایش داده می‌شوند.

![image](https://user-images.githubusercontent.com/45389673/230716796-9fff10fa-56d1-43e7-baca-952f798273a3.png)


### ایجاد ‌آزمون‌رانه (Test-driven Development)
ایجاد آزمون‌رانه یک روش ایجاد نرم‌افزار است که در آن ابتدا test ها و سپس کد لازم برای pass شدن آن‌ها نوشته می‌شود. این روش باعث می‌شود تا افراد تیم ایجاد نرم‌افزار بیشتر تمرکز خود را بر روی نیازمندی‌ها (که در قالب test ها نوشته شده‌اند) قرار دهند. گام‌های اجرای TDD عبارتند از:

1. گام اول: انتظارات از برنامه را به صورت unit test بنویسید. این کار در Java با استفاده از کتابخانه‌ی JUnit انجام می‌شود.
3. گام دوم: test ها را compile کرده و error های آن را شناسایی کنید.
4. گام سوم: با اضافه کردن کد در برنامه اصلی، compile error ها را برطرف نمایید.
5. گام چهارم: test ها را اجرا (run) کنید تا اشکالات زمان اجرا مشخص گردد.
6. گام پنجم: با تغییر کد در برنامه، runtime error ها را رفع نمایید.

## استفاده از TDD
پروژه‌ای ساده به زبان جاوا در 
[اینجا](../../base-projects/library)
قرار دارد. فایل‌های برنامه در پوشه
`src`
قرار دارند. شما قرار است ابتدا ایرادات موجود این برنامه را بیابید و سپس با استفاده از روش
TDD
به آن تعدادی قابلیت اضافه کنید.
با توجه به این توضیحات کارهای زیر را انجام دهید:

1. در این پروژه مجموعا ۲ ایراد وجود دارد. آن‌ها را پیدا کنید، برای هرکدام تستی بنویسید که آن ایراد را تشخیص دهد، در نهایت برنامه را طوری تغییر دهید که ایرادها برطرف شده باشند. تست‌های خود را در مسیر
`src/test`
قرار دهید.
1. در فایل
`Library.java`
دو تابع جستجو وجود دارد که باید با توجه به کامنت‌های آن‌ها و با استفاده از روش 
TDD
کاملشان کنید. برای این کار ابتدا تعدادی تست بنویسید که نیازمندی‌های این ۲ تابع را پوشش دهند، سپس ۲ تابع را به شکلی کامل کنید که همه آن‌ها پاس شوند.

گزارش مختصری از مراحل انجام آزمایش را در فایل README.md پروژه بنویسید.




## پرسش‌ها
پاسخ پرسش‌های زیر را داخل فایل README پروژه بنویسید:


۱. روش
TDD
را با روش تست کردن سنتی که در آن بعد از نوشتن برنامه، تست‌ها نوشته می‌شوند، از نظر نوع پروژه‌هایی که هر یک برای آن‌ها مناسب هست، مقایسه کنید.


۲. در فرایند ایجاد نرم‌افزار هم تیم ایجاد
(Development Team)
و هم تیم تضمین کیفیت
(QA Team)
وظیفه تست نرم‌افزار را برعهده دارند.
هر کدام از این تیم‌ها بیش‌تر با کدام دسته از انواع تست سروکار دارد؟ چرا؟ انواع تست ذکر شده را به طور مختصر شرح دهید.


۳. روالی ‬‫را که‬ ‫برای‬ ‫پروژه‬ ‫‪json-simle‬‬ ‫ارائه‬ ‫شد‬،‬ ‫برای‬ پروژه ای که بر روی آن مشغول هستید هم‬ ‫انجام‬ ‫دهید.
برای ‫به‬ ‫دست‬‫‌آوردن‬ ‫اعداد‬ ‫پوشش‬ ‫آزمون‬ ‫کافی‬ ‫است‬ ‫بر‬ ‫روی‬ ‫پکیج‬ ‫‪java‬‬ ‫در‬ ‫مسیر‬ ‫‪test‬‬ ‫کلیک‬ ‫راست‬ ‫کرده‬ ‫و‬ ‫گزینه ‬‫‪coverage‬‬ ‫‪with‬‬ ‫‪Tests‬‬ ‫‪All‬‬ ‫‪Run‬‬ ‫را‬ ‫انتخاب‬ ‫کنید‬ ‫(نیازی‬ ‫به‬ ‫اجرای‬ ‫عادی‬ ‫پروژه‬ ‫نیست)‪.‬‬‫


۴. با افزودن بخش‌هایی به کد تست، اعداد پوشش آزمون را در مورد تمامی کلاس‌های موجود در برنامه بهبود دهید. درصد افزایش اعداد پوشش آزمون مهم نیست ولی بخش‌هایی که به کد تست اضافه می‌شوند باید معنادار باشند و صرفاً یک فراخوانی ساده کلاس یا متد، بدون استفاده در بخش‌های دیگر کد کافی نیست. 



## نحوه ارسال پروژه:
آدرس مخزن پروژه خود را ارسال کنید. توجه کنید که مخزن شما و کانبان آن عمومی (public) باشد.

</div>
